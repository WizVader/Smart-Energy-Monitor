Version 4
SHEET 1 4332 2012
WIRE 288 -176 208 -176
WIRE 368 -176 352 -176
WIRE 464 -176 448 -176
WIRE 480 -176 464 -176
WIRE 528 -176 480 -176
WIRE 624 -176 528 -176
WIRE 704 -176 624 -176
WIRE 1024 -176 960 -176
WIRE 1104 -176 1024 -176
WIRE 1200 -176 1104 -176
WIRE 1312 -176 1200 -176
WIRE -512 -128 -656 -128
WIRE -320 -128 -512 -128
WIRE -64 -128 -320 -128
WIRE -320 -96 -320 -128
WIRE -64 -80 -64 -128
WIRE 352 -80 352 -176
WIRE 368 -80 352 -80
WIRE 464 -80 464 -176
WIRE 464 -80 448 -80
WIRE 1312 -64 1312 -176
WIRE 1024 -32 1024 -176
WIRE 1104 -32 1104 -176
WIRE 528 -16 528 -176
WIRE 624 -16 624 -176
WIRE 1856 0 1856 -80
WIRE -656 16 -656 -128
WIRE -320 16 -320 -16
WIRE 2336 16 2096 16
WIRE -64 80 -64 0
WIRE 48 80 -64 80
WIRE 2192 96 2192 64
WIRE 2096 112 2096 16
WIRE 2160 112 2096 112
WIRE 2336 128 2336 16
WIRE 2336 128 2224 128
WIRE 2400 128 2336 128
WIRE 528 144 528 48
WIRE 624 144 624 48
WIRE 624 144 528 144
WIRE 832 144 832 -80
WIRE 832 144 624 144
WIRE 1024 144 1024 32
WIRE 1024 144 832 144
WIRE 1104 144 1104 32
WIRE 1104 144 1024 144
WIRE 1312 144 1312 16
WIRE 1312 144 1104 144
WIRE 1856 144 1856 80
WIRE 2032 144 1856 144
WIRE 2160 144 2032 144
WIRE -64 160 -64 80
WIRE 1856 160 1856 144
WIRE 2032 160 2032 144
WIRE -320 176 -320 96
WIRE -320 176 -400 176
WIRE -208 176 -320 176
WIRE -192 176 -208 176
WIRE -400 192 -400 176
WIRE -320 192 -320 176
WIRE 528 208 528 144
WIRE 2032 240 2032 224
WIRE -400 304 -400 272
WIRE -320 304 -320 272
WIRE -320 304 -400 304
WIRE -656 352 -656 96
WIRE -496 352 -656 352
WIRE -320 352 -320 304
WIRE -320 352 -496 352
WIRE -64 352 -64 240
WIRE -64 352 -320 352
WIRE 1856 352 1856 240
WIRE 2384 560 2304 560
WIRE 2416 560 2416 544
WIRE 3504 560 3424 560
WIRE 3536 560 3536 544
WIRE 2624 576 2448 576
WIRE 3696 576 3568 576
WIRE 3760 576 3696 576
WIRE 2384 592 2112 592
WIRE 3296 592 3264 592
WIRE 3408 592 3376 592
WIRE 3504 592 3408 592
WIRE -128 624 -160 624
WIRE -32 624 -64 624
WIRE 496 624 464 624
WIRE 592 624 560 624
WIRE 1024 624 960 624
WIRE 1152 624 1104 624
WIRE 1216 624 1152 624
WIRE 1296 624 1216 624
WIRE 1600 624 1584 624
WIRE 1728 624 1680 624
WIRE 1792 624 1728 624
WIRE 1152 656 1152 624
WIRE 1728 656 1728 624
WIRE 3408 704 3408 592
WIRE 3536 704 3408 704
WIRE 3696 704 3696 576
WIRE 3696 704 3616 704
WIRE 464 752 464 624
WIRE 480 752 464 752
WIRE 592 752 592 624
WIRE 592 752 560 752
WIRE 1152 752 1152 720
WIRE 1728 752 1728 720
WIRE -160 768 -160 624
WIRE -144 768 -160 768
WIRE -32 768 -32 624
WIRE -32 768 -64 768
WIRE 352 816 256 816
WIRE 464 816 464 752
WIRE 464 816 432 816
WIRE -272 832 -480 832
WIRE -160 832 -160 768
WIRE -160 832 -192 832
WIRE 464 832 464 816
WIRE 496 832 464 832
WIRE 528 832 528 816
WIRE -480 848 -480 832
WIRE -160 848 -160 832
WIRE -128 848 -160 848
WIRE -96 848 -96 832
WIRE 592 848 592 752
WIRE 592 848 560 848
WIRE 688 848 592 848
WIRE -32 864 -32 768
WIRE -32 864 -64 864
WIRE 80 864 -32 864
WIRE 496 864 464 864
WIRE -128 880 -160 880
WIRE 352 880 256 880
WIRE 464 880 464 864
WIRE 464 880 432 880
WIRE 480 880 464 880
WIRE -160 896 -160 880
WIRE -160 896 -304 896
WIRE -144 896 -160 896
WIRE 464 896 464 880
WIRE 480 896 480 880
WIRE 496 896 480 896
WIRE -160 912 -160 896
WIRE -144 912 -144 896
WIRE -128 912 -144 912
WIRE 256 912 256 880
WIRE 496 912 496 896
WIRE 576 912 496 912
WIRE -128 944 -128 912
WIRE -80 944 -128 944
WIRE 576 944 576 912
WIRE 464 992 464 976
WIRE -160 1008 -160 992
WIRE -80 1024 -80 1008
WIRE 576 1040 576 1008
WIRE -304 1136 -304 976
FLAG -496 352 0
FLAG -512 -128 Vac
FLAG -208 176 Vis
FLAG 528 880 0
FLAG 528 816 5V
FLAG 256 816 0
FLAG 1584 624 Vio
FLAG 464 992 2V1
FLAG -96 896 0
FLAG -96 832 5V
FLAG 48 80 Vvs
FLAG -160 1008 2V1
FLAG 1152 752 0
FLAG 1216 624 Vvf
FLAG 1728 752 0
FLAG 1792 624 Vif
FLAG -192 -400 0
FLAG -192 -480 5VDis
FLAG 160 -400 0
FLAG 160 -480 Vsens
FLAG 528 208 0
FLAG 208 -176 Vac
FLAG 1200 -176 5V
FLAG 480 -176 Vin
FLAG 2416 608 0
FLAG 2416 544 5V
FLAG 2304 560 2V1
FLAG 3536 608 0
FLAG 3536 544 5V
FLAG 3424 560 2V1
FLAG 80 864 Vvo
FLAG 1856 352 0
FLAG 2400 128 2V1
FLAG 1856 -80 5V
FLAG 2192 160 0
FLAG 2192 64 5V
FLAG -80 1024 0
FLAG 576 1040 0
FLAG 960 624 Vvo
FLAG 2112 592 Vvf
FLAG 3264 592 Vif
FLAG 688 848 Vio
FLAG -480 848 0
FLAG -304 1136 Vvs
FLAG 256 912 Vis
FLAG 2032 240 0
SYMBOL voltage -656 0 R0
WINDOW 0 24 96 Left 2
WINDOW 3 22 124 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vsupply1
SYMATTR Value SINE(0 19.8 500)
SYMBOL res -336 0 R0
SYMATTR InstName Rload1
SYMATTR Value 94.028
SYMBOL ind -336 -112 R0
SYMATTR InstName Lload1
SYMATTR Value 4mH
SYMBOL res -336 176 R0
SYMATTR InstName Rs1
SYMATTR Value 1
SYMBOL res -80 -96 R0
SYMATTR InstName Ra1
SYMATTR Value 56k
SYMBOL res -80 144 R0
SYMATTR InstName Rb1
SYMATTR Value 2.7k
SYMBOL Opamps/opamp2 528 784 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res 448 864 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R1
SYMATTR Value 47k
SYMBOL res 448 800 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R2
SYMATTR Value 47k
SYMBOL res 576 736 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res 480 992 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL Opamps/opamp2 -96 800 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL res -48 752 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res -144 1008 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL res 1120 608 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf1
SYMATTR Value 10k
SYMBOL cap 1168 720 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf1
SYMATTR Value 3.3n
SYMBOL res 1696 608 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 10k
SYMBOL cap 1744 720 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf2
SYMATTR Value 3.3n
SYMBOL voltage -192 -496 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5V
SYMBOL voltage 160 -496 R0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(0 0.5 500)
SYMATTR Value2 AC .1 0
SYMBOL PowerProducts/LT1085-5 832 -176 R0
SYMATTR InstName Reg1
SYMBOL res 1296 -80 R0
SYMATTR InstName RL1
SYMATTR Value 56
SYMBOL res 464 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rreg
SYMATTR Value 27
SYMBOL diode 288 -160 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL cap 512 -16 R0
SYMATTR InstName Cin1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=0.001
SYMBOL cap 1088 -32 R0
SYMATTR InstName Cout1
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=0.001
SYMBOL Opamps/opamp2 2416 512 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL Opamps/opamp2 3536 512 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U4
SYMATTR Value LM324
SYMBOL res 3392 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 3632 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 280k
SYMBOL OpAmps\\opamp2 2192 64 R0
SYMATTR InstName U5
SYMATTR Value LM324
SYMBOL res 1840 -16 R0
SYMATTR InstName R13
SYMATTR Value 47k
SYMBOL res 1840 144 R0
SYMATTR InstName R14
SYMATTR Value 33k
SYMBOL cap -96 944 R0
SYMATTR InstName C1
SYMATTR Value 330p
SYMBOL cap -64 608 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 330p
SYMBOL cap 560 608 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 330p
SYMBOL cap 560 944 R0
SYMATTR InstName C4
SYMATTR Value 330p
SYMBOL res -416 176 R0
SYMATTR InstName Rs2
SYMATTR Value 1
SYMBOL res -176 816 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res -320 880 R0
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL cap 608 -16 R0
SYMATTR InstName C5
SYMATTR Value 100n
SYMBOL cap 1008 -32 R0
SYMATTR InstName C6
SYMATTR Value 100n
SYMBOL cap 2016 160 R0
SYMATTR InstName C7
SYMATTR Value 100n
SYMBOL res 464 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 82
TEXT -528 -232 Left 2 ;AC Source, Load and Sensors
TEXT -368 -88 Right 2 ;Load \n(2.5VA-7.5VA)
TEXT -168 376 Right 2 ;Current Sensor (Shunt)
TEXT -648 616 Left 2 ;Voltage Sensing (Voltage Divider)
TEXT -216 -784 Left 3 ;*********************************************************\nELECTENG 209 - TEAM 09\nThis file contains the hardware for our project.\n*********************************************************
TEXT 1136 -688 Left 2 ;.ac dec 30 1 1Meg
TEXT 1136 -752 Left 2 !.lib LM324.lib
TEXT 1128 -784 Left 2 ;Simulation Commands
TEXT 1136 -720 Left 2 !.tran 0 0.5 0 0.1m
TEXT 1136 -656 Left 2 !.ic V(Vin)=8
TEXT -208 -608 Left 2 ;Power/Signal Sources
TEXT 1848 -312 Left 2 ;Voltage Divider + Buffer
TEXT 1040 512 Left 2 ;Voltage Filter
TEXT 1624 520 Left 2 ;Current Filter
TEXT 2072 432 Left 2 ;Comparator for Voltage Sensing
TEXT 3224 400 Left 2 ;Comparator for Current Sensing
TEXT 704 -328 Left 2 ;Regulator/ Power Supply
TEXT 1336 384 Left 2 ;FILTERS
TEXT 296 552 Left 2 ;Current Sensing
TEXT 2024 720 Left 2 ;Taken off the resistors from this comparator. \nWhy? - Because The output (Vout) is A.(v+ -  v-). \n- In our case, Vvf is being fed into the v+ terminal \n- 2.1 offset (Vref) is being fed into the v-  terminal.\n- When the Vvf crosses the Vref voltage line positively/negatively,\nVout will be equal to infinity (open loop gain) times the difference in terminal voltages,\n- meaning the output will shoot up to positive/neative infinity respectively, but it will be limited to \n+5V (~3.5V) and 0V (~700mV) due to OPAMP power rails
TEXT 56 1176 Left 2 !;ac dec 30 1 1Meg
TEXT 472 264 Left 2 ;In our final PCB, we did not implement the 100nF capacitors
TEXT 3248 776 Left 2 ;This is not implemented in the PCB
RECTANGLE Normal -360 -108 -232 108 2
RECTANGLE Normal -360 168 -232 280 2
RECTANGLE Normal -116 -156 20 312 2
RECTANGLE Normal 1096 -800 1532 -628 2
